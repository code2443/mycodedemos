var TaskData=function(){var a=this;return a.cate_list=[],a.task_list=[],a.get_cate_item=function(a){var b=jQuery(a);return{cate:b.data("cate"),name:b.text(),root:b.data("root"),itemclass:b.data("class")}},a.init_cate=function(b){var c=b.find("li");jQuery.each(c,function(b,c){var d=a.get_cate_item(c);a.cate_list.push(d)})},a.get_task_cate=function(b){b=b.toLocaleLowerCase();var c=a.cate_list.slice(0);c.sort(function(a,b){return a.cate.length>b.cate.length?-1:1});for(var d=0;d<c.length;d++){var e=c[d],f=b.indexOf(e.cate),g=b.indexOf("w"+e.cate);if(f>=0&&0>g)return{val:e.cate,index:b.substr(f+e.cate.length)}}return null},a.get_task_item=function(b){var c=jQuery(b),d={name:c.text(),url:c.attr("href")},e=d.name.match(/\u3010(\S*?)\u3011/);if(e.length<2)return null;d.cate=e[1],d.name=d.name.replace(e[0],""),c.text();var g=a.get_task_cate(d.cate);return null==g?null:(d.cate=g.val,d.index=g.index,d)},a.init_task=function(b){var c=b.find("a");jQuery.each(c,function(b,c){var d=a.get_task_item(c);d&&a.task_list.push(d)})},a.get_catelist=function(b){return jQuery.grep(a.cate_list,function(a){return a.root==b})},a.get_tasklist=function(b){return jQuery.grep(a.task_list,function(a){return a.cate==b})},a.find_tasklist=function(b){return jQuery.grep(a.task_list,function(a){return a.name.indexOf(b)>=0})},a.init=function(){a.init_cate(jQuery(".main_frame .all_cate")),a.init_task(jQuery(".main_frame .all_task"))},a},TaskAnimate=function(){var a=this;return a.show_children=function(a,b){a.addClass("animateing"),a.addClass("open");var c=a.parent(),d=c.children(".children_frame"),e=d.children(".children");d.animate({height:e.height()},400,"easeInOutQuart",function(){d.css({height:"auto"}),a.removeClass("animateing"),b&&b()})},a.hide_children=function(a,b){a.addClass("animateing"),a.removeClass("open");var c=a.parent(),d=c.children(".children_frame");d.children(".children"),d.animate({height:0},400,"easeInOutQuart",function(){a.removeClass("animateing"),b&&b()})},a.bindevent=function(b){b.hasClass("bindevent")||(b.addClass("bindevent"),b.bind("click",function(){var b=jQuery(this);b.hasClass("animateing")||(b.hasClass("open")?a.hide_children(b):a.show_children(b))}))},a},TaskList=function(){var a=this;return a.taskdata=null,a.animate=new TaskAnimate,a.all_task_frame=null,a.set_data=function(b){a.taskdata=b},a.uie=function(a){return jQuery("<"+a+"></"+a+">")},a.write_task_item=function(b){var c=a.uie("li"),d=a.uie("a"),e=a.uie("b"),f=a.uie("span");return c.append(d),d.attr({href:b.url,target:"_blank"}),d.append(e),d.append(f),e.html(b.cate+b.index),f.html(b.name),c},a.write_tasks=function(b){var c=a.uie("ul");return jQuery.each(b,function(b,d){var e=a.write_task_item(d);c.append(e)}),c},a.write_tasks_order=function(b){var c=a.taskdata.get_tasklist(b);return c.sort(function(a,b){return parseInt(a.index)>parseInt(b.index)?1:-1}),a.write_tasks(c)},a.hasChildrenCate=function(a){return a.cate.indexOf("_root")>0},a.write_cate=function(b){var c=a.uie("div"),d=a.uie("div"),e=a.uie("i"),f=a.uie("span");c.append(d),c.addClass("cate"),c.addClass(b.itemclass),d.addClass("title"),d.append(e),d.append(f),f.html(b.name);var h,g=a.uie("div");return h=a.hasChildrenCate(b)?a.write_cates(b.cate):a.write_tasks_order(b.cate),h&&(g.addClass("children_frame"),c.append(g),h.addClass("children"),g.append(h)),a.animate.bindevent(d),c},a.write_cates=function(b){var c=a.uie("div"),d=a.taskdata.get_catelist(b);return jQuery.each(d,function(b,d){var e=a.write_cate(d);c.append(e)}),c},a.write_all=function(){a.all_task_frame.empty();var b=a.write_cates("root");b.addClass("all_cate"),a.all_task_frame.append(b)},a.init=function(){a.all_task_frame=jQuery(".main_frame .main_content .tasklist")},a.open_first=function(){var a=jQuery(".main_content .all_cate .cate:first .title");a.trigger("click")},a},taskdata=null,tasklist=null;jQuery(document).ready(function(){taskdata=new TaskData,taskdata.init(),tasklist=new TaskList,tasklist.set_data(taskdata),tasklist.init(),tasklist.write_all(),setTimeout(tasklist.open_first,0)});